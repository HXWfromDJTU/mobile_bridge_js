{"version":3,"sources":["webpack://MobileBridge/webpack/universalModuleDefinition","webpack://MobileBridge/./node_modules/_eventemitter3@4.0.7@eventemitter3/index.js","webpack://MobileBridge/./node_modules/_lodash.uniqueid@4.0.1@lodash.uniqueid/index.js","webpack://MobileBridge/./src/MobileBridge.ts","webpack://MobileBridge/./src/api/BaseAPI.ts","webpack://MobileBridge/./src/api/TestModule.ts","webpack://MobileBridge/./src/api/index.ts","webpack://MobileBridge/./src/channel/IframeChannel.ts","webpack://MobileBridge/./src/channel/NativeChannel.ts","webpack://MobileBridge/./src/constant/index.ts","webpack://MobileBridge/./src/constant/rescode.ts","webpack://MobileBridge/./src/helper/index.ts","webpack://MobileBridge/./src/index.ts","webpack://MobileBridge/webpack/bootstrap","webpack://MobileBridge/webpack/startup","webpack://MobileBridge/webpack/runtime/global"],"names":["root","factory","exports","module","define","amd","self","has","Object","prototype","hasOwnProperty","prefix","Events","EE","fn","context","once","this","addListener","emitter","event","TypeError","listener","evt","_events","push","_eventsCount","clearEvent","EventEmitter","create","__proto__","eventNames","events","name","names","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","args","len","arguments","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","freeGlobal","g","freeSelf","Function","objectProto","idCounter","objectToString","toString","Symbol","symbolProto","symbolToString","value","id","isObjectLike","isSymbol","result","baseToString","extendStatics","__extends","d","b","setPrototypeOf","p","__","constructor","defineProperty","IframeChannel_1","helper_1","constant_1","rescode_1","NativeChannel_1","pkg","uniqueId","MobileBridge","_super","apiDict","_this","logger","window","console","version","_promises","Map","SDK_NAME","isIframeEnv","debug","_channel","IframeChannel","onmessage","data","includes","JSON_RPC_KEY","JSON_RPC_VERSION","response","NativeChannel","NativeSDKGlobalKey","_i","_a","keys","key","_roundTripTimer","setInterval","entries","_b","callbackPromise","Date","getTime","createdAt","warn","EXPIRE_DURATION","method","HEARTBEAT_DURATION","message","JSON","parse","err","error","isNotify","data_1","NOTIFY_PREFIX","isRequest","params","isResponse","errCode","data_2","errMsg","get","delete","RES_CODE","success","resolve","reject","request","payload","Promise","assign","set","postMessage","default","BaseAPI","bridge","_bridge","_request","TestModule","sendTestMessage","getAddressFromAddressBook","API","testApi","parent","useChannelName","isIOS","isAndroid","UAInfo","getAllUserAgent","ios","android","_c","webkit","messageHandlers","navigator","userAgent","dataToString","stringify","TEST_API_KEY","msgObj","every","requestKey","top","ua","toLowerCase","windows","ubuntu","mac","MobileBridge_1","api_1","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","globalThis","e"],"mappings":"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","file":"mobile_bridge_js.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MobileBridge\"] = factory();\n\telse\n\t\troot[\"MobileBridge\"] = factory();\n})(self, function() {\nreturn ","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to generate unique IDs. */\nvar idCounter = 0;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {string} [prefix=''] The value to prefix the ID with.\n * @returns {string} Returns the unique ID.\n * @example\n *\n * _.uniqueId('contact_');\n * // => 'contact_104'\n *\n * _.uniqueId();\n * // => '105'\n */\nfunction uniqueId(prefix) {\n  var id = ++idCounter;\n  return toString(prefix) + id;\n}\n\nmodule.exports = uniqueId;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar EventEmitter = require(\"eventemitter3\");\nvar IframeChannel_1 = require(\"./channel/IframeChannel\");\nvar helper_1 = require(\"./helper\");\nvar constant_1 = require(\"./constant\");\nvar rescode_1 = require(\"./constant/rescode\");\nvar NativeChannel_1 = require(\"./channel/NativeChannel\");\nvar pkg = require('../package.json');\nvar uniqueId = require('lodash.uniqueid');\nvar MobileBridge = /** @class */ (function (_super) {\n    __extends(MobileBridge, _super);\n    function MobileBridge(apiDict) {\n        var _this = _super.call(this) || this;\n        _this.logger = window.console;\n        _this.version = pkg.version;\n        _this._promises = new Map();\n        window[constant_1.SDK_NAME] = _this;\n        // 初始化信道\n        if (helper_1.isIframeEnv()) {\n            console.debug(constant_1.SDK_NAME + \".init: use IframeChannel\");\n            // 发消息\n            _this._channel = new IframeChannel_1.IframeChannel();\n            // 接收消息\n            window.onmessage = function (event) {\n                _this.logger.debug(constant_1.SDK_NAME + \"-iframe-receive message, ready to handle\", event);\n                // 确认消息格式\n                if (event.data\n                    && typeof event.data === 'string'\n                    && event.data.includes(\"\\\"\" + constant_1.JSON_RPC_KEY + \"\\\":\\\"\" + constant_1.JSON_RPC_VERSION + \"\\\"\")) {\n                    // todo: 收到消息后，处理消息\n                    _this.response(event.data);\n                }\n            };\n        }\n        else {\n            console.debug(constant_1.SDK_NAME + \".init: use NativeChannel\");\n            // 使用 native channel 封装 各平台的 webview postMessage 的api\n            _this._channel = new NativeChannel_1.NativeChannel(constant_1.NativeSDKGlobalKey, console);\n        }\n        // 绑定 API_DICT 实例到 Bridge 上\n        for (var _i = 0, _a = Object.keys(apiDict); _i < _a.length; _i++) {\n            var key = _a[_i];\n            // 实例化api, 并使用 MobileBridge 作为信道，并绑定到全局\n            _this[key] = new apiDict[key](_this);\n        }\n        // 添加请求 RTT 过长警告  todo: 清理计时器\n        _this._roundTripTimer = setInterval(function () {\n            for (var _i = 0, _a = _this._promises.entries(); _i < _a.length; _i++) {\n                var _b = _a[_i], msgId = _b[0], callbackPromise = _b[1];\n                var RTT = new Date().getTime() - callbackPromise.createdAt.getTime();\n                if (RTT) {\n                    _this.logger.warn(constant_1.SDK_NAME + \"-checking: request RTT is over \" + constant_1.EXPIRE_DURATION + \", method: \", callbackPromise.method);\n                }\n            }\n        }, constant_1.HEARTBEAT_DURATION);\n        return _this;\n    }\n    /**\n     * response 起到的是 handleRequest 的作用, 可以是内部自动调用，也可以是使用者调用\n     * @param data 信道传输过来的 string 消息，期望是 IRequest 格式的 JSON_STRING\n     */\n    MobileBridge.prototype.response = function (data) {\n        // 尝试转换为 JSON 格式消息\n        var message;\n        try {\n            message = JSON.parse(data);\n            this.logger.debug(constant_1.SDK_NAME + \"-response receive:\", data);\n        }\n        catch (err) {\n            this.logger.error(constant_1.SDK_NAME + \"-response parse data error.\", data);\n            return;\n        }\n        if (helper_1.isNotify(message)) {\n            var id = message.id, data_1 = message.data;\n            this.logger.debug(constant_1.SDK_NAME + \": receive notify\", id);\n            // 收到请求，使用事件机制对外暴露\n            this.emit(\"\" + constant_1.NOTIFY_PREFIX, data_1);\n            return;\n        }\n        // 该消息为 请求类型 的消息\n        if (helper_1.isRequest(message)) {\n            var id = message.id, method = message.method, params = message.params;\n            this.logger.debug(constant_1.SDK_NAME + \": receive request\", id);\n            // 收到请求，使用事件机制对外暴露\n            this.emit(constant_1.NOTIFY_PREFIX + \":\" + method, params);\n            return;\n        }\n        // 该消息为 响应类型 的消息\n        if (helper_1.isResponse(message)) {\n            var id = message.id, errCode = message.errCode, data_2 = message.data, errMsg = message.errMsg;\n            // 从请求记录中，找到请求时设定的promise处理\n            var callbackPromise = this._promises.get(id);\n            if (callbackPromise) {\n                // 判断是否超时,给出警告\n                var RTT = new Date().getTime() - callbackPromise.createdAt.getTime();\n                if (RTT > constant_1.EXPIRE_DURATION) {\n                    this.logger.warn(constant_1.SDK_NAME + \"-response: receive response more than \" + constant_1.EXPIRE_DURATION + \"s\");\n                }\n                // 移除对对应的promise\n                this._promises.delete(id);\n                this.logger.debug(constant_1.SDK_NAME + \"-response, remove callback promise, id = \" + id);\n                // 执行对应的callback promise\n                if (errCode === rescode_1.RES_CODE.success) {\n                    this.logger.debug(constant_1.SDK_NAME + \"-response: response data\", data_2);\n                    // 调用 reject 方法处理异常回复\n                    callbackPromise.resolve.call(this, data_2);\n                }\n                else {\n                    this.logger.debug(constant_1.SDK_NAME + \"-response: received error\", errMsg);\n                    // 调用 resolve 方法处理正常回复\n                    callbackPromise.reject.call(this, errMsg);\n                }\n            }\n            else {\n                // 发现是 response 消息，但本地没有找到 对应请求 promise 记录\n                this.logger.error(constant_1.SDK_NAME + \"-response, no promise for this message\", message);\n                return;\n            }\n        }\n    };\n    /**\n     * 发送消息\n     * @param payload 发送的数据体\n     * @param isNotify\n     */\n    MobileBridge.prototype.request = function (payload, isNotify) {\n        var _this = this;\n        if (isNotify === void 0) { isNotify = false; }\n        return new Promise(function (resolve, reject) {\n            var _a;\n            // 包装请求\n            payload = Object.assign(payload, (_a = {\n                    id: isNotify ? constant_1.NOTIFY_PREFIX : uniqueId(constant_1.SDK_NAME + \"-\")\n                },\n                _a[constant_1.JSON_RPC_KEY] = constant_1.JSON_RPC_VERSION,\n                _a));\n            // 若发送的不是一个 通知类型 的消息，则需要记录其处理方式\n            if (!isNotify) {\n                _this.logger.debug(constant_1.SDK_NAME + \"-request add callback promise, id =\", payload.id);\n                // 使用 Map 保存请求对应的处理promise\n                _this._promises.set(payload.id, {\n                    resolve: resolve,\n                    reject: reject,\n                    method: payload.method,\n                    createdAt: new Date(),\n                });\n            }\n            _this.logger.debug(constant_1.SDK_NAME + \"-request message send, payload =\", payload);\n            _this._channel.postMessage(payload);\n        });\n    };\n    return MobileBridge;\n}(EventEmitter));\nexports.default = MobileBridge;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseAPI = void 0;\nvar BaseAPI = /** @class */ (function () {\n    function BaseAPI(bridge) {\n        this._bridge = bridge;\n    }\n    BaseAPI.prototype._request = function (payload, isNotify) {\n        if (isNotify === void 0) { isNotify = false; }\n        return this._bridge.request(payload, isNotify);\n    };\n    return BaseAPI;\n}());\nexports.BaseAPI = BaseAPI;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar BaseAPI_1 = require(\"./BaseAPI\");\nvar TestModule = /** @class */ (function (_super) {\n    __extends(TestModule, _super);\n    function TestModule() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TestModule.prototype.sendTestMessage = function () {\n        return this._request({\n            method: 'test_method',\n            params: {}\n        });\n    };\n    TestModule.prototype.getAddressFromAddressBook = function () {\n        return this._request({\n            method: 'getAddressFromAddressBook',\n            params: {}\n        });\n    };\n    return TestModule;\n}(BaseAPI_1.BaseAPI));\nexports.default = TestModule;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar TestModule_1 = require(\"./TestModule\");\nvar API = {\n    testApi: TestModule_1.default\n};\nexports.default = API;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.IframeChannel = void 0;\nvar IframeChannel = /** @class */ (function () {\n    function IframeChannel() {\n    }\n    IframeChannel.prototype.postMessage = function (data) {\n        window.parent.postMessage(data, '*'); // 不限制接收源\n    };\n    return IframeChannel;\n}());\nexports.IframeChannel = IframeChannel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NativeChannel = void 0;\nvar helper_1 = require(\"../helper\");\nvar constant_1 = require(\"../constant\");\nvar NativeChannel = /** @class */ (function () {\n    /**\n     *\n     * @param useChannelName 当前用于通信的信道对象，在window上的key值\n     * @param logger\n     */\n    function NativeChannel(useChannelName, logger) {\n        this.isIOS = false;\n        this.isAndroid = false;\n        var UAInfo = helper_1.getAllUserAgent();\n        this.logger = logger;\n        this.useChannelName = useChannelName;\n        this.isIOS = UAInfo.ios;\n        this.isAndroid = UAInfo.android;\n    }\n    NativeChannel.prototype.postMessage = function (data) {\n        var _a, _b, _c;\n        this.logger.debug(constant_1.SDK_NAME + \"-NativeChannel send message\", data);\n        if (this.isAndroid) {\n            this.logger.debug(constant_1.SDK_NAME + \"-NativeChannel Android send message\", data);\n            var bridge = window[this.useChannelName];\n            if (bridge && bridge.postMessage) {\n                bridge.postMessage(data);\n            }\n            else {\n                this.logger.error(constant_1.SDK_NAME + \"-NativeChannel Android: bridge not found in window, name =\", this.useChannelName);\n            }\n        }\n        else if (this.isIOS) {\n            this.logger.debug(constant_1.SDK_NAME + \"-NativeChannel iOS send message\", data);\n            if ((_c = (_b = (_a = window.webkit) === null || _a === void 0 ? void 0 : _a.messageHandlers) === null || _b === void 0 ? void 0 : _b[this.useChannelName]) === null || _c === void 0 ? void 0 : _c.postMessage) {\n                window.webkit.messageHandlers[this.useChannelName].postMessage(data);\n            }\n            else {\n                this.logger.error(constant_1.SDK_NAME + \"-NativeChannel iOS: bridge not found in messageHandlers, name =\", this.useChannelName);\n            }\n        }\n        else {\n            this.logger.error(constant_1.SDK_NAME + \"-NativeChannel platform not supported, userAgent = \", window.navigator.userAgent);\n        }\n    };\n    NativeChannel.dataToString = function (data) {\n        return typeof data === 'string' ? data : JSON.stringify(data);\n    };\n    return NativeChannel;\n}());\nexports.NativeChannel = NativeChannel;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HEARTBEAT_DURATION = exports.NOTIFY_PREFIX = exports.EXPIRE_DURATION = exports.JSON_RPC_KEY = exports.JSON_RPC_VERSION = exports.NativeSDKGlobalKey = exports.TEST_API_KEY = exports.SDK_NAME = void 0;\nexports.SDK_NAME = 'MobileBridge';\nexports.TEST_API_KEY = 'API_TEST';\nexports.NativeSDKGlobalKey = 'MobileBridgeNative';\nexports.JSON_RPC_VERSION = '2.0';\nexports.JSON_RPC_KEY = 'jsonrpc';\n// 通信超时时间\nexports.EXPIRE_DURATION = 3000;\nexports.NOTIFY_PREFIX = 'notify';\n// 检测通路的时隔\nexports.HEARTBEAT_DURATION = 1000;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RES_CODE = void 0;\nexports.RES_CODE = {\n    success: 0\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getAllUserAgent = exports.isIframeEnv = exports.isResponse = exports.isNotify = exports.isRequest = void 0;\nvar constant_1 = require(\"../constant\");\nfunction isRequest(msgObj) {\n    var requestKeys = ['jsonrpc', 'id', 'method', 'params'];\n    // 检查是否符合所有的 IRequest Key\n    return requestKeys.every(function (requestKey) {\n        return msgObj.hasOwnProperty(requestKey);\n    });\n}\nexports.isRequest = isRequest;\nfunction isNotify(msgObj) {\n    var notifyKeys = ['jsonrpc', 'id', 'data'];\n    // 检查是否符合所有的 IRequest Key\n    var allKeys = notifyKeys.every(function (requestKey) {\n        return msgObj.hasOwnProperty(requestKey);\n    });\n    return allKeys && msgObj.id === constant_1.NOTIFY_PREFIX;\n}\nexports.isNotify = isNotify;\nfunction isResponse(msgObj) {\n    var responseKeys = ['jsonrpc', 'id', 'errCode'];\n    // 检查是否符合所有的 IRequest Key\n    return responseKeys.every(function (requestKey) {\n        return msgObj.hasOwnProperty(requestKey);\n    });\n}\nexports.isResponse = isResponse;\nfunction isIframeEnv() {\n    return window.self !== window.top;\n}\nexports.isIframeEnv = isIframeEnv;\n/**\n * 获取当前平台以及应用信息\n */\nfunction getAllUserAgent() {\n    var ua = window.navigator.userAgent.toLowerCase();\n    return {\n        // 平台UA\n        android: ua.includes('android'),\n        ios: ua.includes('iphone') || ua.includes('ipad'),\n        windows: ua.includes('windows'),\n        ubuntu: ua.includes('ubuntu'),\n        mac: ua.includes('mac'),\n    };\n}\nexports.getAllUserAgent = getAllUserAgent;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MobileBridge_1 = require(\"./MobileBridge\");\nvar constant_1 = require(\"./constant\");\nvar api_1 = require(\"./api\");\n// 绑定到全局\nwindow[constant_1.SDK_NAME] = MobileBridge_1.default;\nwindow[constant_1.TEST_API_KEY] = api_1.default;\nexports.default = MobileBridge_1.default;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(109);\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();"],"sourceRoot":""}